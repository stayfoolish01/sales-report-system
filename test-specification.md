# 営業日報システム テスト仕様書

## 1. テスト概要

### 1.1 目的
営業日報システムの品質を保証するため、機能テスト、統合テスト、非機能テストを実施する

### 1.2 テスト対象
- バックエンドAPI
- フロントエンド画面
- データベース連携
- 認証・認可機能
- パフォーマンス
- セキュリティ

### 1.3 テスト環境
| 項目 | 内容 |
|------|------|
| OS | Windows 11 / macOS / Linux |
| ブラウザ | Chrome 最新版、Firefox 最新版、Safari 最新版 |
| モバイル | iOS Safari、Android Chrome |
| データベース | PostgreSQL 15以上 / MySQL 8.0以上 |
| Node.js | 18.x以上 |

### 1.4 テストデータ
- テスト用営業担当者: 10名
- テスト用顧客: 50社
- テスト用日報: 100件
- テスト期間: 2024年1月1日～2024年12月31日

---

## 2. 機能テスト

### 2.1 認証機能

#### TC-AUTH-001: ログイン成功
**テスト目的**: 正しい認証情報でログインできることを確認

**事前条件**:
- テストユーザーが登録済み（email: test@example.com, password: Test1234）

**テスト手順**:
1. ログイン画面を開く
2. メールアドレスに "test@example.com" を入力
3. パスワードに "Test1234" を入力
4. ログインボタンをクリック

**期待結果**:
- ダッシュボード画面に遷移する
- アクセストークンが発行される
- ユーザー名が画面に表示される

**優先度**: 高

---

#### TC-AUTH-002: ログイン失敗（パスワード誤り）
**テスト目的**: 誤ったパスワードでログインできないことを確認

**事前条件**:
- テストユーザーが登録済み（email: test@example.com）

**テスト手順**:
1. ログイン画面を開く
2. メールアドレスに "test@example.com" を入力
3. パスワードに "WrongPassword" を入力
4. ログインボタンをクリック

**期待結果**:
- エラーメッセージ「メールアドレスまたはパスワードが正しくありません」が表示される
- ログイン画面のまま遷移しない
- HTTPステータス: 401

**優先度**: 高

---

#### TC-AUTH-003: ログイン失敗（未登録メールアドレス）
**テスト目的**: 未登録のメールアドレスでログインできないことを確認

**テスト手順**:
1. ログイン画面を開く
2. メールアドレスに "nonexistent@example.com" を入力
3. パスワードに "Test1234" を入力
4. ログインボタンをクリック

**期待結果**:
- エラーメッセージ「メールアドレスまたはパスワードが正しくありません」が表示される
- HTTPステータス: 401

**優先度**: 高

---

#### TC-AUTH-004: バリデーションエラー（メールアドレス形式不正）
**テスト目的**: メールアドレス形式が不正な場合にバリデーションエラーが表示されることを確認

**テスト手順**:
1. ログイン画面を開く
2. メールアドレスに "invalid-email" を入力
3. パスワードに "Test1234" を入力
4. ログインボタンをクリック

**期待結果**:
- エラーメッセージ「正しいメールアドレス形式で入力してください」が表示される
- APIリクエストは送信されない

**優先度**: 中

---

#### TC-AUTH-005: ログアウト
**テスト目的**: ログアウトが正常に動作することを確認

**事前条件**:
- ログイン済み

**テスト手順**:
1. ヘッダーのユーザー名をクリック
2. ドロップダウンメニューから「ログアウト」を選択

**期待結果**:
- ログイン画面に遷移する
- アクセストークンが無効化される
- ダッシュボードURLに直接アクセスしてもログイン画面にリダイレクトされる

**優先度**: 高

---

#### TC-AUTH-006: トークン有効期限切れ
**テスト目的**: トークン有効期限切れ時に再認証が求められることを確認

**事前条件**:
- ログイン済み
- アクセストークンの有効期限が1時間

**テスト手順**:
1. ログイン後、1時間以上経過させる（または手動でトークンを期限切れにする）
2. 日報一覧などのAPIを呼び出す操作を実行

**期待結果**:
- HTTPステータス: 401
- ログイン画面にリダイレクトされる
- エラーメッセージ「セッションが切れました。再度ログインしてください」が表示される

**優先度**: 中

---

### 2.2 日報管理機能

#### TC-REPORT-001: 日報作成成功（最小構成）
**テスト目的**: 必須項目のみで日報が作成できることを確認

**事前条件**:
- 営業担当者としてログイン済み
- 顧客マスタに最低1件のデータが存在

**テスト手順**:
1. ダッシュボードから「日報作成」をクリック
2. 日付を選択（本日）
3. 訪問記録1件目の顧客を選択
4. 訪問内容を入力（例: "商品提案を実施"）
5. 「提出」ボタンをクリック

**期待結果**:
- 日報が作成される（HTTPステータス: 201）
- 日報詳細画面に遷移する
- 成功メッセージ「日報を作成しました」が表示される
- データベースに日報と訪問記録が保存される

**優先度**: 高

---

#### TC-REPORT-002: 日報作成成功（全項目入力）
**テスト目的**: すべての項目を入力して日報が作成できることを確認

**事前条件**:
- 営業担当者としてログイン済み
- 顧客マスタに複数のデータが存在

**テスト手順**:
1. 日報作成画面を開く
2. 日付を選択
3. 訪問記録1件目: 顧客A、訪問内容を入力
4. 「訪問記録を追加」をクリック
5. 訪問記録2件目: 顧客B、訪問内容を入力
6. 課題・相談（Problem）を入力
7. 明日の予定（Plan）を入力
8. 「提出」ボタンをクリック

**期待結果**:
- 日報が作成される
- 訪問記録が2件登録される
- ProblemとPlanが保存される
- 日報詳細画面でデータが正しく表示される

**優先度**: 高

---

#### TC-REPORT-003: 日報作成失敗（訪問記録なし）
**テスト目的**: 訪問記録が1件もない場合にエラーになることを確認

**テスト手順**:
1. 日報作成画面を開く
2. 日付を選択
3. 訪問記録を追加せず、ProblemとPlanのみ入力
4. 「提出」ボタンをクリック

**期待結果**:
- バリデーションエラーが表示される
- エラーメッセージ「訪問記録は最低1件必要です」が表示される
- HTTPステータス: 400
- 日報は作成されない

**優先度**: 高

---

#### TC-REPORT-004: 日報作成失敗（同一日付重複）
**テスト目的**: 同じ日付の日報が既に存在する場合にエラーになることを確認

**事前条件**:
- 2024年1月15日の日報が既に提出済み

**テスト手順**:
1. 日報作成画面を開く
2. 日付に2024年1月15日を選択
3. 訪問記録を入力
4. 「提出」ボタンをクリック

**期待結果**:
- エラーメッセージ「この日付の日報は既に存在します」が表示される
- HTTPステータス: 409
- 日報は作成されない

**優先度**: 高

---

#### TC-REPORT-005: 日報作成（下書き保存）
**テスト目的**: 下書きとして保存できることを確認

**テスト手順**:
1. 日報作成画面を開く
2. 日付を選択
3. 訪問記録を入力
4. 「下書き保存」ボタンをクリック

**期待結果**:
- 日報がstatusが'draft'で保存される
- 日報一覧画面に遷移する
- 一覧で「📝下書き」と表示される
- 下書きは後から編集・提出可能

**優先度**: 中

---

#### TC-REPORT-006: 日報編集成功
**テスト目的**: 既存の日報を編集できることを確認

**事前条件**:
- 自分が作成した日報が存在

**テスト手順**:
1. 日報詳細画面を開く
2. 「編集」ボタンをクリック
3. 訪問内容を変更
4. Problemを変更
5. 「提出」ボタンをクリック

**期待結果**:
- 日報が更新される（HTTPステータス: 200）
- 変更内容が反映される
- updated_atが更新される
- 日報詳細画面で変更内容が表示される

**優先度**: 高

---

#### TC-REPORT-007: 日報編集失敗（権限なし）
**テスト目的**: 他人の日報を編集できないことを確認

**事前条件**:
- ユーザーAでログイン
- ユーザーBが作成した日報が存在

**テスト手順**:
1. ユーザーBの日報詳細画面を開く（URLを直接入力）
2. PUT /reports/{report_id} APIを直接呼び出す

**期待結果**:
- 編集ボタンが表示されない
- APIを直接呼び出してもHTTPステータス: 403
- エラーメッセージ「この日報を編集する権限がありません」

**優先度**: 高

---

#### TC-REPORT-008: 日報削除成功
**テスト目的**: 自分の日報を削除できることを確認

**事前条件**:
- 自分が作成した日報が存在

**テスト手順**:
1. 日報一覧画面を開く
2. 削除したい日報の削除ボタンをクリック
3. 確認ダイアログで「削除」を選択

**期待結果**:
- 日報が削除される（HTTPステータス: 204）
- データベースから日報と関連する訪問記録が削除される
- 一覧から該当日報が消える

**優先度**: 中

---

#### TC-REPORT-009: 日報一覧取得（デフォルト条件）
**テスト目的**: デフォルト条件で日報一覧が取得できることを確認

**事前条件**:
- 営業担当者としてログイン済み
- 自分の日報が複数件存在

**テスト手順**:
1. ダッシュボードから「日報一覧」をクリック

**期待結果**:
- 当月の自分の日報が一覧表示される
- 最新日付順にソートされている
- 1ページ10件表示
- 日付、ステータス、訪問顧客、コメント件数が表示される

**優先度**: 高

---

#### TC-REPORT-010: 日報一覧検索（期間指定）
**テスト目的**: 期間を指定して日報を検索できることを確認

**テスト手順**:
1. 日報一覧画面を開く
2. 開始日に "2024-01-01" を入力
3. 終了日に "2024-01-31" を入力
4. 「検索」ボタンをクリック

**期待結果**:
- 指定期間内の日報のみ表示される
- 期間外の日報は表示されない
- 件数が正しく表示される

**優先度**: 中

---

#### TC-REPORT-011: 日報一覧検索（顧客名部分一致）
**テスト目的**: 顧客名で日報を検索できることを確認

**テスト手順**:
1. 日報一覧画面を開く
2. 顧客名に "ABC" を入力
3. 「検索」ボタンをクリック

**期待結果**:
- "ABC"を含む顧客に訪問した日報のみ表示される
- 部分一致で検索される（例: "株式会社ABC"、"ABC商事"など）

**優先度**: 中

---

#### TC-REPORT-012: 日報一覧ページネーション
**テスト目的**: ページネーションが正しく動作することを確認

**事前条件**:
- 15件以上の日報が存在

**テスト手順**:
1. 日報一覧画面を開く
2. 「次へ」ボタンをクリック
3. 「前へ」ボタンをクリック

**期待結果**:
- 1ページ目に10件表示
- 「次へ」クリックで2ページ目に遷移、残りの日報が表示される
- 「前へ」クリックで1ページ目に戻る
- ページ番号が正しく表示される（例: "1 / 2"）

**優先度**: 中

---

### 2.3 コメント機能

#### TC-COMMENT-001: コメント追加成功（Problem）
**テスト目的**: 上長が部下の日報のProblemにコメントできることを確認

**事前条件**:
- 上長としてログイン済み
- 部下の日報が存在

**テスト手順**:
1. 部下の日報詳細画面を開く
2. Problem欄のコメント入力欄に "来週の部会で同席します" を入力
3. 「送信」ボタンをクリック

**期待結果**:
- コメントが追加される（HTTPステータス: 201）
- コメントがProblem欄の下に表示される
- コメント者名と投稿日時が表示される
- 部下側でも該当コメントが閲覧可能

**優先度**: 高

---

#### TC-COMMENT-002: コメント追加成功（Plan）
**テスト目的**: 上長が部下の日報のPlanにコメントできることを確認

**テスト手順**:
1. 部下の日報詳細画面を開く
2. Plan欄のコメント入力欄に "了解です。頑張ってください。" を入力
3. 「送信」ボタンをクリック

**期待結果**:
- コメントがPlan欄の下に追加される
- comment_typeが'plan'で保存される

**優先度**: 高

---

#### TC-COMMENT-003: コメント追加失敗（権限なし：一般営業）
**テスト目的**: 一般営業担当者がコメントできないことを確認

**事前条件**:
- 一般営業担当者としてログイン済み
- 他人の日報が存在

**テスト手順**:
1. 他人の日報詳細画面を開く
2. POST /reports/{report_id}/comments APIを直接呼び出す

**期待結果**:
- コメント入力欄が表示されない
- APIを直接呼び出してもHTTPステータス: 403
- エラーメッセージ「コメントする権限がありません」

**優先度**: 高

---

#### TC-COMMENT-004: コメント削除成功
**テスト目的**: 自分が投稿したコメントを削除できることを確認

**事前条件**:
- 上長としてログイン済み
- 自分が投稿したコメントが存在

**テスト手順**:
1. 日報詳細画面を開く
2. 自分のコメントの「削除」ボタンをクリック
3. 確認ダイアログで「削除」を選択

**期待結果**:
- コメントが削除される（HTTPステータス: 204）
- コメントが画面から消える

**優先度**: 中

---

#### TC-COMMENT-005: コメントバリデーション（500文字超過）
**テスト目的**: 500文字を超えるコメントが投稿できないことを確認

**テスト手順**:
1. 日報詳細画面を開く
2. コメント入力欄に501文字のテキストを入力
3. 「送信」ボタンをクリック

**期待結果**:
- バリデーションエラーが表示される
- エラーメッセージ「コメントは500文字以内で入力してください」

**優先度**: 中

---

### 2.4 顧客マスタ管理機能

#### TC-CUSTOMER-001: 顧客登録成功
**テスト目的**: 新規顧客を登録できることを確認

**事前条件**:
- 上長としてログイン済み

**テスト手順**:
1. 顧客マスタ一覧画面を開く
2. 「新規登録」ボタンをクリック
3. 会社名: "株式会社テスト"
4. 顧客名: "テスト太郎"
5. 部署: "営業部"
6. 電話番号: "03-1234-5678"
7. メールアドレス: "test@test.co.jp"
8. 住所: "東京都千代田区..."
9. 「保存」ボタンをクリック

**期待結果**:
- 顧客が登録される（HTTPステータス: 201）
- 顧客マスタ一覧に戻る
- 新規登録した顧客が一覧に表示される
- 成功メッセージ「顧客を登録しました」が表示される

**優先度**: 高

---

#### TC-CUSTOMER-002: 顧客登録失敗（必須項目未入力）
**テスト目的**: 必須項目が未入力の場合にエラーになることを確認

**テスト手順**:
1. 顧客登録画面を開く
2. 会社名のみ入力（顧客名は空白）
3. 「保存」ボタンをクリック

**期待結果**:
- バリデーションエラーが表示される
- エラーメッセージ「顧客名は必須項目です」
- HTTPステータス: 400
- 顧客は登録されない

**優先度**: 高

---

#### TC-CUSTOMER-003: 顧客編集成功
**テスト目的**: 既存顧客の情報を編集できることを確認

**事前条件**:
- 顧客が登録済み

**テスト手順**:
1. 顧客マスタ一覧画面を開く
2. 編集したい顧客の「編集」ボタンをクリック
3. 電話番号を変更
4. 「保存」ボタンをクリック

**期待結果**:
- 顧客情報が更新される（HTTPステータス: 200）
- 変更内容が反映される
- 一覧画面で変更後の情報が表示される

**優先度**: 高

---

#### TC-CUSTOMER-004: 顧客削除成功
**テスト目的**: 未使用の顧客を削除できることを確認

**事前条件**:
- 日報で使用されていない顧客が存在

**テスト手順**:
1. 顧客マスタ一覧画面を開く
2. 削除したい顧客の「削除」ボタンをクリック
3. 確認ダイアログで「削除」を選択

**期待結果**:
- 顧客が削除される（HTTPステータス: 204）
- 一覧から該当顧客が消える

**優先度**: 中

---

#### TC-CUSTOMER-005: 顧客削除失敗（使用中）
**テスト目的**: 日報で使用中の顧客は削除できないことを確認

**事前条件**:
- 日報の訪問記録で使用されている顧客が存在

**テスト手順**:
1. 顧客マスタ一覧画面を開く
2. 使用中の顧客の「削除」ボタンをクリック
3. 確認ダイアログで「削除」を選択

**期待結果**:
- HTTPステータス: 409
- エラーメッセージ「この顧客は日報で使用されているため削除できません」
- 顧客は削除されない

**優先度**: 中

---

#### TC-CUSTOMER-006: 顧客検索（部分一致）
**テスト目的**: 顧客名・会社名で部分一致検索できることを確認

**テスト手順**:
1. 顧客マスタ一覧画面を開く
2. 検索欄に "ABC" を入力
3. 「検索」ボタンをクリック

**期待結果**:
- "ABC"を含む顧客のみ表示される
- 顧客名、会社名どちらにマッチしても表示される

**優先度**: 中

---

#### TC-CUSTOMER-007: 顧客マスタ閲覧（一般営業）
**テスト目的**: 一般営業担当者が顧客マスタを閲覧できることを確認

**事前条件**:
- 一般営業担当者としてログイン済み

**テスト手順**:
1. 顧客マスタ一覧画面を開く

**期待結果**:
- 顧客一覧が表示される
- 「新規登録」ボタンが表示されない
- 各顧客の「編集」「削除」ボタンが表示されない

**優先度**: 中

---

### 2.5 営業マスタ管理機能

#### TC-SALES-001: 営業担当者登録成功
**テスト目的**: 新規営業担当者を登録できることを確認

**事前条件**:
- 上長としてログイン済み

**テスト手順**:
1. 営業マスタ一覧画面を開く
2. 「新規登録」ボタンをクリック
3. 氏名: "新人太郎"
4. メールアドレス: "shingin@example.com"
5. パスワード: "Test1234"
6. 部署: "営業一部"
7. 役職: "営業"
8. 上長: 自分を選択
9. 権限レベル: "一般"
10. 「保存」ボタンをクリック

**期待結果**:
- 営業担当者が登録される（HTTPステータス: 201）
- 営業マスタ一覧に戻る
- 新規登録した営業担当者が一覧に表示される
- パスワードはハッシュ化されてDB保存される

**優先度**: 高

---

#### TC-SALES-002: 営業担当者登録失敗（メール重複）
**テスト目的**: 既存のメールアドレスでは登録できないことを確認

**事前条件**:
- "test@example.com" のユーザーが既に登録済み

**テスト手順**:
1. 営業担当者登録画面を開く
2. すべての項目を入力
3. メールアドレスに "test@example.com" を入力
4. 「保存」ボタンをクリック

**期待結果**:
- HTTPステータス: 409
- エラーメッセージ「このメールアドレスは既に登録されています」
- 営業担当者は登録されない

**優先度**: 高

---

#### TC-SALES-003: 営業担当者編集成功
**テスト目的**: 既存営業担当者の情報を編集できることを確認

**テスト手順**:
1. 営業マスタ一覧画面を開く
2. 編集したい営業担当者の「編集」ボタンをクリック
3. 役職を変更
4. 「保存」ボタンをクリック

**期待結果**:
- 営業担当者情報が更新される（HTTPステータス: 200）
- 変更内容が反映される

**優先度**: 高

---

#### TC-SALES-004: 営業担当者削除失敗（日報存在）
**テスト目的**: 日報が存在する営業担当者は削除できないことを確認

**事前条件**:
- 日報を作成済みの営業担当者が存在

**テスト手順**:
1. 営業マスタ一覧画面を開く
2. 日報を持つ営業担当者の「削除」ボタンをクリック
3. 確認ダイアログで「削除」を選択

**期待結果**:
- HTTPステータス: 409
- エラーメッセージ「この営業担当者は日報が存在するため削除できません」

**優先度**: 中

---

#### TC-SALES-005: 営業マスタアクセス拒否（一般営業）
**テスト目的**: 一般営業担当者が営業マスタにアクセスできないことを確認

**事前条件**:
- 一般営業担当者としてログイン済み

**テスト手順**:
1. 営業マスタ一覧のURLに直接アクセス

**期待結果**:
- HTTPステータス: 403
- エラーメッセージ「アクセス権限がありません」
- ダッシュボードにメニューが表示されない

**優先度**: 高

---

### 2.6 ダッシュボード機能

#### TC-DASHBOARD-001: ダッシュボード表示（一般営業）
**テスト目的**: 一般営業のダッシュボードが正しく表示されることを確認

**事前条件**:
- 一般営業担当者としてログイン済み
- 未提出の日報が1件存在
- 未読コメントが3件存在

**テスト手順**:
1. ログイン後、ダッシュボードが表示される

**期待結果**:
- ユーザー名が表示される
- 本日の日付が表示される
- 未提出の日報数が "1件" と表示される
- 未読コメント数が "3件" と表示される
- 日報作成、日報一覧、顧客マスタへのリンクが表示される
- 営業マスタへのリンクは表示されない

**優先度**: 高

---

#### TC-DASHBOARD-002: ダッシュボード表示（上長）
**テスト目的**: 上長のダッシュボードが正しく表示されることを確認

**事前条件**:
- 上長としてログイン済み
- 部下が5名存在
- 部下の未提出日報が2件存在

**テスト手順**:
1. ログイン後、ダッシュボードが表示される

**期待結果**:
- 自分の統計情報が表示される
- 部下の未提出日報数が "2件" と表示される
- 部下の人数が "5名" と表示される
- 営業マスタへのリンクが表示される

**優先度**: 高

---

## 3. 統合テスト

### 3.1 日報作成からコメントまでの一連フロー

#### TC-INTEGRATION-001: 日報作成→コメント→返信フロー
**テスト目的**: 営業担当者が日報を作成し、上長がコメントする一連の流れを確認

**テスト手順**:
1. 営業担当者Aでログイン
2. 日報を作成（訪問記録2件、Problem記入）
3. 日報を提出
4. ログアウト
5. 上長Bでログイン
6. 営業担当者Aの日報を開く
7. Problemにコメントを追加
8. ログアウト
9. 営業担当者Aで再ログイン
10. 自分の日報を開く

**期待結果**:
- すべての操作が正常に完了
- 営業担当者Aの日報詳細画面で上長Bのコメントが表示される
- 未読コメント数がダッシュボードに反映される

**優先度**: 高

---

### 3.2 顧客登録から日報作成までのフロー

#### TC-INTEGRATION-002: 顧客登録→日報作成フロー
**テスト目的**: 新規顧客を登録し、その顧客への訪問日報を作成する流れを確認

**テスト手順**:
1. 上長でログイン
2. 顧客マスタから新規顧客を登録（株式会社新規）
3. ログアウト
4. 営業担当者でログイン
5. 日報作成画面を開く
6. 訪問記録の顧客選択で「株式会社新規」を選択
7. 日報を提出

**期待結果**:
- すべての操作が正常に完了
- 新規登録した顧客が日報作成時の選択肢に表示される
- 日報詳細画面で顧客情報が正しく表示される

**優先度**: 中

---

## 4. 非機能テスト

### 4.1 パフォーマンステスト

#### TC-PERF-001: 日報一覧表示速度
**テスト目的**: 日報一覧が2秒以内に表示されることを確認

**事前条件**:
- 日報が1000件存在

**テスト手順**:
1. 日報一覧画面を開く
2. 表示完了までの時間を計測

**期待結果**:
- 2秒以内に画面が表示される
- ページネーションにより10件のみ取得

**優先度**: 中

---

#### TC-PERF-002: 初期ページロード速度
**テスト目的**: 初期ページロードが3秒以内に完了することを確認

**テスト手順**:
1. ブラウザのキャッシュをクリア
2. ログイン画面を開く
3. ロード完了までの時間を計測

**期待結果**:
- 3秒以内にページが表示される

**優先度**: 低

---

#### TC-PERF-003: API同時アクセス
**テスト目的**: 複数ユーザーの同時アクセスに耐えられることを確認

**テスト手順**:
1. 50ユーザーが同時に日報一覧APIを呼び出す
2. レスポンスタイムを計測

**期待結果**:
- すべてのリクエストが5秒以内に完了
- エラーが発生しない

**優先度**: 低

---

### 4.2 セキュリティテスト

#### TC-SEC-001: SQLインジェクション対策
**テスト目的**: SQLインジェクション攻撃に対して安全であることを確認

**テスト手順**:
1. ログイン画面でメールアドレスに "' OR '1'='1" を入力
2. パスワードに "' OR '1'='1" を入力
3. ログインボタンをクリック

**期待結果**:
- ログインできない
- SQLエラーが発生しない
- 適切なエラーメッセージが表示される

**優先度**: 高

---

#### TC-SEC-002: XSS対策
**テスト目的**: XSS攻撃に対して安全であることを確認

**テスト手順**:
1. 日報作成画面を開く
2. 訪問内容に "<script>alert('XSS')</script>" を入力
3. 日報を提出
4. 日報詳細画面を開く

**期待結果**:
- スクリプトが実行されない
- HTML特殊文字がエスケープされて表示される
- "&lt;script&gt;alert('XSS')&lt;/script&gt;" と表示される

**優先度**: 高

---

#### TC-SEC-003: CSRF対策
**テスト目的**: CSRF攻撃に対して安全であることを確認

**テスト手順**:
1. 外部サイトから日報作成APIを呼び出す
2. CSRFトークンなしでリクエストを送信

**期待結果**:
- HTTPステータス: 403
- リクエストが拒否される

**優先度**: 中

---

#### TC-SEC-004: パスワード保護
**テスト目的**: パスワードが適切にハッシュ化されていることを確認

**テスト手順**:
1. 新規営業担当者を登録
2. データベースのsales_staffテーブルを確認

**期待結果**:
- パスワードが平文で保存されていない
- bcryptなどでハッシュ化されている

**優先度**: 高

---

### 4.3 レスポンシブテスト

#### TC-RESPONSIVE-001: スマートフォン表示（iPhone）
**テスト目的**: iPhone環境で正しく表示されることを確認

**テスト手順**:
1. iPhone（画面幅375px）でログイン画面を開く
2. 各画面を操作

**期待結果**:
- すべての画面がモバイル表示に最適化される
- ボタンがタップしやすいサイズ
- 横スクロールが発生しない
- テキストが読みやすい

**優先度**: 中

---

#### TC-RESPONSIVE-002: タブレット表示（iPad）
**テスト目的**: iPad環境で正しく表示されることを確認

**テスト手順**:
1. iPad（画面幅768px）で各画面を開く

**期待結果**:
- レイアウトがタブレット用に調整される
- PCとモバイルの中間的なレイアウト

**優先度**: 低

---

### 4.4 ブラウザ互換性テスト

#### TC-BROWSER-001: Chrome最新版
**期待結果**: すべての機能が正常に動作

**優先度**: 高

---

#### TC-BROWSER-002: Firefox最新版
**期待結果**: すべての機能が正常に動作

**優先度**: 中

---

#### TC-BROWSER-003: Safari最新版
**期待結果**: すべての機能が正常に動作

**優先度**: 中

---

#### TC-BROWSER-004: Edge最新版
**期待結果**: すべての機能が正常に動作

**優先度**: 低

---

## 5. テストデータ

### 5.1 営業担当者テストデータ

```sql
-- 上長
INSERT INTO sales_staff (name, email, password, department, position, manager_id, role)
VALUES ('佐藤次郎', 'sato@example.com', 'hashed_password', '営業一部', '部長', NULL, 'admin');

-- 一般営業
INSERT INTO sales_staff (name, email, password, department, position, manager_id, role)
VALUES ('山田太郎', 'yamada@example.com', 'hashed_password', '営業一部', '主任', 1, 'general');
```

### 5.2 顧客テストデータ

```sql
INSERT INTO customer (customer_name, company_name, department, phone, email, address)
VALUES
('鈴木一郎', '株式会社ABC', '営業部', '03-1234-5678', 'suzuki@abc.co.jp', '東京都千代田区...'),
('田中花子', '株式会社XYZ', '総務部', '03-2345-6789', 'tanaka@xyz.co.jp', '東京都港区...');
```

---

## 6. テスト実施計画

### 6.1 テストスケジュール

| フェーズ | 期間 | 内容 |
|---------|------|------|
| 単体テスト | 1週間 | 各機能の単体テスト |
| 統合テスト | 3日間 | 機能間連携のテスト |
| 非機能テスト | 2日間 | パフォーマンス、セキュリティテスト |
| リグレッションテスト | 1日間 | 全体の再テスト |

### 6.2 テスト担当

| 担当者 | 役割 |
|--------|------|
| テストリーダー | テスト計画・管理 |
| テスター1 | 認証・日報機能テスト |
| テスター2 | マスタ管理・コメント機能テスト |
| テスター3 | 非機能テスト |

### 6.3 合格基準

- 優先度「高」のテストケース: 100%成功
- 優先度「中」のテストケース: 95%以上成功
- 優先度「低」のテストケース: 90%以上成功
- 致命的バグ: 0件
- 重大バグ: 2件以下

---

## 7. 不具合管理

### 7.1 不具合の優先度

| レベル | 定義 |
|--------|------|
| 致命的 | システムが動作しない、データ損失の危険性 |
| 重大 | 主要機能が使用不可、回避策なし |
| 中 | 機能に問題があるが回避策あり |
| 軽微 | 使用に影響しない、見た目の問題 |

### 7.2 不具合報告フォーマット

```
タイトル: [機能名] 簡潔な不具合内容
優先度: 致命的 / 重大 / 中 / 軽微
再現手順:
1. ...
2. ...
3. ...
期待結果: ...
実際の結果: ...
環境: OS, ブラウザ, バージョン
スクリーンショット: (添付)
```

---

## 8. 変更履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0.0 | 2024-01-15 | 初版作成 |